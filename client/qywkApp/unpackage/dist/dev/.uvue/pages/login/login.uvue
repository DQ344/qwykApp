

























	import type { TloginInfo, IToken } from "@/common/type/user.uts"
	import type { IResponse } from "@/common/type/http.uts"
	import { BASE_URL } from "@/config/index.uts"
	
	// import Http from "@/utils/http"
	// import utils from "@/utils/utils.uts"
	
	export default {
		data() {
			return {
				loginInfo: {
					username: '',
					password: ''
				} as TloginInfo
			}
		},
		methods: {
			clickLogin() {
				if((this.loginInfo.username.length <= 0) || (this.loginInfo.password.length <= 0)) return 
				
				console.log(this.loginInfo);
				// Http.post('/qywk/login/normal', this.loginInfo)
				uni.request<IResponse<IToken>>({
					url: BASE_URL + '/qywk/login/normal',
					method: 'POST',
					data: {
						username: this.loginInfo.username,
						password: this.loginInfo.password
					},
					dataType: 'json',
					success: (res) => {
						let r = res.data
						console.log('登录返回信息', r);
						if(r!.code == 200) {
							uni.setStorageSync('token', r!.data!.token)
							uni.reLaunch({
								url: '/pages/index/index',
							})
						} else {
							
							uni.showToast({
								title: "账号或密码错误",
								icon: "none"
							})
						}
						
					},
					fail: (err) => {
						console.log(err);
						uni.showToast({
							title: "账号或密码错误",
							icon: "none"
						})
					}
				})

			}
		}
	}


function GenPagesLoginLoginRender(): VNode | null {
const _ctx = this
const _cache = this.$.renderCache
const _component_button = resolveComponent("button")

  return createElementVNode("view", utsMapOf({ class: "login" }), [
    createElementVNode("image", utsMapOf({
      class: "bg-img",
      src: "/static/image/login/bg.png",
      mode: "widthFix"
    })),
    createElementVNode("view", utsMapOf({ class: "window flex flex-column align-center" }), [
      createElementVNode("view", utsMapOf({ class: "top flex align-center" }), [
        createElementVNode("image", utsMapOf({
          src: "/static/image/login/chacha.png",
          mode: "widthFix",
          style: "width: 36rpx;margin-right: 10rpx;"
        })),
        createElementVNode("text", utsMapOf({ class: "title justify-start" }), "登录")
      ]),
      createElementVNode("input", utsMapOf({
        modelValue: _ctx.loginInfo.username,
        onInput: ($event: InputEvent): any => {_ctx.loginInfo.username = $event.detail.value;
return $event.detail.value;},
        class: "uni-input space",
        placeholder: "账号/手机号"
      }), null, 40 /* PROPS, HYDRATE_EVENTS */, ["modelValue", "onInput"]),
      createElementVNode("input", utsMapOf({
        modelValue: _ctx.loginInfo.password,
        onInput: ($event: InputEvent): any => {_ctx.loginInfo.password = $event.detail.value;
return $event.detail.value;},
        class: "uni-input space",
        password: "",
        type: "text",
        placeholder: "密码"
      }), null, 40 /* PROPS, HYDRATE_EVENTS */, ["modelValue", "onInput"]),
      createVNode(_component_button, utsMapOf({
        class: "space",
        "hover-class": "btn-hover",
        onClick: _ctx.clickLogin,
        style: "width: 600rpx;height: 76rpx;border-radius: 32rpx;color: #fff;line-height: 76rpx;text-align: center;background-color: #b19983;"
      }), utsMapOf({
        default: withSlotCtx((): any[] => ["登录"]),
        _: 1 /* STABLE */
      }), 8 /* PROPS */, ["onClick"]),
      createElementVNode("view", utsMapOf({ class: "sub space flex justify-between" }), [
        createElementVNode("view", utsMapOf({ class: "forget" }), [
          createElementVNode("text", utsMapOf({ class: "text" }), "忘记密码")
        ]),
        createElementVNode("view", utsMapOf({ class: "sign-up" }), [
          createElementVNode("text", utsMapOf({ class: "text" }), "手机注册")
        ])
      ]),
      createElementVNode("view", utsMapOf({ class: "icons flex justify-around" }), [
        createElementVNode("image", utsMapOf({
          class: "img-icon",
          src: "/static/image/login/QQ.png",
          mode: "widthFix"
        })),
        createElementVNode("image", utsMapOf({
          class: "img-icon",
          src: "/static/image/login/weixin.png",
          mode: "widthFix"
        })),
        createElementVNode("image", utsMapOf({
          class: "img-icon",
          src: "/static/image/login/weibo.png",
          mode: "widthFix"
        }))
      ])
    ])
  ])
}
const GenPagesLoginLoginStyles = [utsMapOf([["login", padStyleMapOf(utsMapOf([["width", "100%"], ["height", "100%"], ["backgroundColor", "#f2eee9"]]))], ["bg-img", utsMapOf([[".login ", utsMapOf([["width", "750rpx"], ["position", "absolute"], ["top", 0]])]])], ["window", utsMapOf([[".login ", utsMapOf([["boxSizing", "border-box"], ["width", "650rpx"], ["height", "766rpx"], ["padding", "30rpx"], ["margin", "300rpx auto 0 auto"], ["backgroundColor", "#f5f5f5"], ["borderRadius", "48rpx"]])]])], ["space", utsMapOf([[".login .window ", utsMapOf([["marginBottom", "62rpx"]])]])], ["top", utsMapOf([[".login .window ", utsMapOf([["width", "600rpx"], ["marginBottom", "64rpx"]])]])], ["title", utsMapOf([[".login .window .top ", utsMapOf([["fontSize", 16], ["color", "#937152"]])]])], ["uni-input", utsMapOf([[".login .window ", utsMapOf([["width", "600rpx"], ["height", "76rpx"], ["borderRadius", "32rpx"], ["margin", "0 auto"], ["paddingLeft", 10], ["fontSize", 12], ["backgroundColor", "#f2eee9"], ["fontSize::placeholder", "28rpx"], ["marginLeft::placeholder", "100rpx"]])]])], ["btn-hover", utsMapOf([[".login .window ", utsMapOf([["backgroundColor", "#94806e"]])]])], ["sub", utsMapOf([[".login .window ", utsMapOf([["width", "600rpx"]])]])], ["text", utsMapOf([[".login .window .sub ", utsMapOf([["fontSize", 12], ["color", "#937152"]])]])], ["icons", utsMapOf([[".login .window ", utsMapOf([["width", "500rpx"], ["height", "56rpx"]])]])], ["img-icon", utsMapOf([[".login .window .icons ", utsMapOf([["width", "56rpx"], ["height", "56rpx"]])]])]])]
